---
title: "GHV - Exercises"
author: "Niels"
date: "2024-02-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, rstanarm)
```

# Chapter 3 - Exercises
#### Exercise 3.1
Weighted averages: A survey is conducted in a certain city regarding support for increased
property taxes to fund schools. In this survey, higher taxes are supported by 50% of respondents
aged 18–29, 60% of respondents aged 30–44, 40% of respondents aged 45–64, and 30% of respondents aged 65 and up. Assume there is no nonresponse. Suppose the sample includes 200 respondents aged 18–29, 250 aged 30–44, 300 aged 45–64,and 250 aged 65+. Use the weighted average formula to compute the proportion of respondents in the sample who support higher taxes.
```{r - 3.1}
tot_3.1 <- 200+250+300+250
sup_taxes_3.1 <- 200/tot_3.1*0.5+250/tot_3.1*0.6+300/tot_3.1*0.4+250/tot_3.1*0.3
sup_taxes_3.1
```
So the weighted average is 44.5% that support higher taxes.

#### Exercise 3.2
Weighted averages: Continuing the previous exercise, suppose you would like to estimate the
proportion of all adults in the population who support higher taxes, so you take a weighted
average as in Section 3.1. Give a set of weights for the four age categories so that the estimated
proportion who support higher taxes for all adults in the city is 40%.
```{r - 3.2}
# I gotta make the equation: weighted average = 0.4 <=> sub_pop1/tot_pop*x1 + sub_pop2/tot_pop*x2 etc.
# If I just lock down everything except how much the young people favor it, then we only have 1 variable.
sub_taxes_3.2 <- 200/tot_3.1*0.275+250/tot_3.1*0.6+300/tot_3.1*0.4+250/tot_3.1*0.3
sub_taxes_3.2
```
Done, probably not the best way to do it, but I didn't need to go figure out how to use a solve-function.

#### Exercise 3.3 - Density functions
Probability distributions: Using R, graph probability densities for the normal distribution,
plotting several different curves corresponding to different choices of mean and standard
deviation parameters.

```{r - 3.3}
# creating distributions
set.seed(1000)
d1_3.3 <- rnorm(10000, 0, sd = 1) # 1000 samples, mean = 0, sd = 1
d2_3.3 <- rnorm(10000, 1, sd = 2) # 1000 samples, mean = 1, sd = 2
d3_3.3 <- rnorm(10000, 10, sd = 3.5) # 1000 samples, mean = 10, sd = 3.5

# combining into one dataframe with additional column for indentifying which distribution
d3.3_data <- data.frame(
  value = c(d1_3.3, d2_3.3, d3_3.3),
  distribution = factor(rep(c("A", "B", "C"), each = 10000)))

# plotting it
ggplot(d3.3_data, aes(x = value, fill = distribution)) + 
  geom_density(alpha = 0.5) + 
  labs(title = "Overlapping Density Plots of 3 Normal DIstributions",
       x = "Value", y = "Density") + 
  scale_fill_manual(values = c("red", "green", "blue"))
```

#### Exercise 3.4 - Poisson Distribution
Probability distributions: Using a bar plot in R, graph the Poisson distribution with parameter
3.5.
```{r - 3.4}
lambda_3.4 <- 3.5 # used for poisson distribution (it's called the rate)
x_values_3.4 <- 0:10

probabilities_3.4 <- dpois(x_values_3.4, lambda_3.4)

poisson_3.4 <- data.frame(value = x_values_3.4, probability = probabilities_3.4)

ggplot(poisson_3.4, aes(x = factor(value), y = probability)) + 
  geom_bar(stat = "identity", fill = "skyblue", color = "blue") + 
    labs(title = "Poisson Distribution with 3.5 Rate", 
         x = "Value",
         y = "Probability")
```

#### Exercise 3.5 - Binomial Distribution
Probability distributions: Using a bar plot in R, graph the binomial distribution with n = 20 and
p = 0.3.
```{r - 3.5}
n_3.5 <- 20
p_3.5 <- 0.3
X_3.5 <- 0:n_3.5
binom_3.5 <- dbinom(X_3.5, n_3.5, p_3.5)

df_3.5 <- data.frame(value = X_3.5, probability = binom_3.5)

ggplot(df_3.5, aes(x = factor(value), y = probability)) + 
  geom_bar(stat = "Identity", fill = "skyblue", color = "blue") + 
  labs(title = "Binomial Distribution of Size 20 with p = 0.3",
       x = "Value",
       y = "Probability")
```
#### Exercise 3.6 - Linear Transformations (The mathy way)
Linear transformations: A test is graded from 0 to 50, with an average score of 35 and a standard deviation of 10. For comparison to other tests, it would be convenient to rescale to a mean of 100 and standard deviation of 15.
*(a) Labeling the original test scores as x and the desired rescaled test score as y, come up with a linear transformation, that is, values of a and b so that the rescaled scores y = a + bx have a mean of 100 and a standard deviation of 15.*
```{r - 3.6}
x_3.6 <- rnorm(1000, 35, sd = 10)
# So I need a way to find out the coefficients a and b that when multiplied/added with the original numbers "x" give me numbers y that get a mean on 100 and sd of 15. 

# So the equation must be:
#y_3.6 = a + b*x_3.6

# I need to do b = 1.5, because 10*1.5 = 15, then we have the standard deviation
#y_3.6 = a + 1.5*x_3.6

# Now let's find a
#m_y = a + b*m_x <=> 100 = a + 1.5*35 <=> 100 - a = 1.5*35 <=> -a = 1.5*35 - 100 = -a = -47.5 <=> a = 47.5

y_self_3.6 <- 47.5 + 1.5*x_3.6

mean(y_self_3.6)
sd(y_self_3.6)
```
Ladies and gentlemen, we got em. 


*(b) What is the range of possible values of this rescaled score y?*
The original test had the possible values between 0 to 50, thus the rescaled test must have a similar spectrum, but of course it is rescaled:
```{r - 3.6b}
y_3.6_min <- 47.5+1.5*0 #where 0 is the original grade
y_3.6_max <- 47.5+1.5*50 # where 50 is the highest possible original grade
```

*(c) Plot the line showing y vs. x.*
```{r - 3.6c}
data_3.6 <- data.frame(x_3.6, y_self_3.6)
ggplot(data_3.6, aes(x = x_3.6, y = y_self_3.6)) + 
  geom_line()
```
It is linear, so we did a good job :)

#### Exercise 3.7 - Linear Transformations (Continued)
Linear transformations: Continuing the previous exercise, there is another linear transformation that also rescales the scores to have mean 100 and standard deviation 15. What is it, and why would you not want to use it for this purpose?
```{r - 3.7}
# It is undesirable to make b negative, because it inverts the scores after the rescaling
# 100 = a - 1.5*35 <=> -a = -52.5 - 100 <=> a = 152.5
y_3.7 <- 152.5 - 1.5*x_3.6
mean(y_3.7)
sd(y_3.7)
ggplot(data_3.6, aes(x = x_3.6, y = y_3.7)) + 
  geom_line()

```

#### Exercise 3.8 - Correlated Random Variables
Correlated random variables: Suppose that the heights of husbands and wives have a correlation of 0.3, husbands’ heights have a distribution with mean 69.1 and standard deviation 2.9 inches, and wives’ heights have mean 63.7 and standard deviation 2.7 inches. Let x and y be the heights of a married couple chosen at random. What are the mean and standard deviation of the average height, (x + y)/2?
```{r - 3.8}
p_3.8 <- 0.3
mh_3.8 <- 69.1
mw_3.8 <- 63.7
sd_h_3.8 <- 2.9
sd_w_3.8 <- 2.7

```


















